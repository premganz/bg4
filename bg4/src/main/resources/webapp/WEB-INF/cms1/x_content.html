<!DOCTYPE html>
<html>
<head>

<title>x_content1</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script src="https://cdn.tiny.cloud/1/pijlljln72gb1mlk2gvsxe2d6cougamz2qopz27dtv0fa3hy/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
<script type="text/javascript">
        tinymce.init({
        	  plugins: "image link code table textcolor",
              image_list: [ 
                  {title: 'My image 1', value: 'http://www.tinymce.com/my1.gif'}, 
                  {title: 'My image 2', value: 'http://www.moxiecode.com/my2.gif'} 
              ],             
            selector: "#mytextarea",
            content_css : "../lcx/clean-blog-lc.min.css" 
            
        });
        
        
        
    </script>
<!-- Bootstrap Core CSS -->
<link th:href="@{/css/bootstrap.min.css}" rel="stylesheet"></link>

<!-- Custom CSS -->
<link th:href="@{/css/clean-blog.min.css}" rel="stylesheet"></link>

<!-- Custom Fonts -->
<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"></link>
<link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'></link>
<link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800'
	rel='stylesheet' type='text/css'></link>

</head>

<body>
<script>
    var greet='';
		
    var greet='';
	$(document).ready(function(){
	  $("#fileselect2").change(function(){
		  var msg= 'Select  '+ $(this).attr('id')+'   '+ $(this).val();
	  $("#myEdit").html(msg);
	  $("#myTextArea").val("new text");
	
	  });
	});
	$(document).ready(function(){
	$("#fileselect1").change(function(){
	    $.ajax({
	    	url: "http://localhost:8089/admin/list2/"+$(this).val(),async: false, 
	    	dataType: 'json',
	    	success: function(data,textStatus){
	    		console.log(data);
	        //$("#myTextArea").val(JSONstringify(data));
	       
	        $("#fileName").prop("background-color", "PINK");
	       // $("#fileName").val(JSONstringify(data));
	        //tinyMCE.get('mytextarea').setContent(JSONstringify(data));
	        var len = data.length;
            $("#fileselect2").empty();
            var i = 0;            
            var options='';
            for (;data[i];) {
            	console.log(data[i]);
              options += '<option value="' + data[i]+ '">' + data[i]+ '</option>';
              i++;
            }
            $("#fileselect2").html(options);
	       //$('#fileselect2').append(['a','b']);
	    },
	    
	    error:function(exception){alert('Exeption:'+exception);}
	    
	    });
	   
	});
	});
	
	
	$(document).ready(function(){
		$("#fileselect2").change(function(){
			console.log($("#fileselect2").val());
		    $.ajax({
		    	url: "http://localhost:8089/admin/list3/"+$("#fileselect1").val()+"/"+$("#fileselect2").val(),
		    	async: false, 
		    	dataType: 'json',
		    	success: function(data,textStatus){
		        var len = data.length;
	            $("#fileselect3").empty();
	            var i = 0;            
	            var options='';
	            for (;data[i];) {
	            	console.log(data[i]);
	              options += '<option value="' + data[i]+ '">' + data[i]+ '</option>';
	              i++;
	            }
	            $("#fileselect3").html(options);
		       //$('#fileselect2').append(['a','b']);
		    },
		    
		    error:function(exception){alert('Exeption:'+exception);}
		    
		    });
		   
		});
		});
	
    
		$(document).ready(function(){
		$("#fetch1").click(function(){
			
		    $.ajax(
		    	{url: "http://localhost:8089/admin/content/"+$("#fileselect1").val()+"/"+$("#fileselect2").val()+"/"+$("#fileselect3").val(),async: false, 
		    	success: function(result){
		    		//tinyMCE.activeEditor.setContent(result);
		    		tinyMCE.get('mytextarea').setContent(result);
		    		$("#fileName").prop("background-color", "PINK");
		    	}
		    	});
		});
		});
		
		
		function JSONstringify(json) {
		    if (typeof json != 'string') {
		        json = JSON.stringify(json, undefined, '\t');
		    }

		    json = json.replace(/\"/g, "");
		    json = json.replace(/\,/g, "");
		    
		   
		    return json;
		}
		
	
		
	</script>
	 
	
	<div class="metadata" >
	<table ><tr>
	<td><h2>Post Controls</h2></td>
	<td>
	
                <ul >
                    <li>
                        <a href="/home">Home</a>
                    </li>
                     <li>
                        <a href="/admin/metrics">Back</a>
                    </li>                 
                </ul>
           
           </td>
	</tr>
	</table>
	</div>
	<div class="metadata">
	<table>
	<tr>
	<td>	Fetch Existing Post:	</td>
	<td>	<button  id="fetch1">Fetch</button>	</td>
	</tr>
	</table>
	
	<form id="form1" action="#" th:action="@{../admin/contentSubmit}" method="post" onsubmit="return confirm('Are you sure?');">
			<!-- <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" /> -->
				<table>
					<tr>
						<td>
							<p>
							<select id="fileselect1" th:field="${content.path1}" >
								<div th:each="link : ${files1}">
								<option th:text="${link}" ></option>					
								</div>
							</select>
							</p>
							 <h5><div th:utext="${content.formErrors}"></div></h5>
							
								<p>FileName  : <input id="fileName" th:name="input" th:field="${content.id}" maxlength="100" />Meta : <input id="fileMeta" th:name="input" th:field="*{content.meta}" maxlength="500" /></p>
																					
						</td>
						<td><br></br> <button  id="fetch" onClick="loadContent()">Post</button></td>
						
					</tr>
					<tr>
						<td>
							<p>
							<select name="fileselect2" id="fileselect2"  th:field="${content.path2}">
   								 <option value="1">Please Choose</option>
  							</select>
							</p>
							<p>
							<select name="fileselect3" id="fileselect3"  th:field="${content.path3}">
   								 <option value="1">Please Choose</option>
  							</select>
							</p>
							
							 <h5><div th:utext="${content.formErrors}"></div></h5>
							
								
																					
						</td>
						<td><br></br> <button  id="fetch" onClick="loadContent()">Post</button></td>
						
					</tr>
				</table>
			
		<div class="container">
			<div class="row">
				<p>					
					<textarea id="mytextarea" th:field="*{content.htmlContent}" cols="80" rows="40"></textarea>
					<br></br> <input type="submit" id="doUpdate" name="_eventId_updateData" value="POST" onclick="return confirm('Are you sure you want to save?')"/> 
				</p>

			</div>
		</div>
	</form>
	</div>
	
</body>
</html>